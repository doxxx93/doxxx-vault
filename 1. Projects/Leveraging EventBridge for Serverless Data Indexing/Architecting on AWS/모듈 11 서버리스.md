---
date_created: 2024-06-10 19:04
author: 
date_published: 
url:
---
# 모듈 11 서버리스

![](Pasted%20image%2020240610190552.png)

# Amazon API Gateway

## Amazon API Gateway의 기능

- 개발자가 API를 생성, 게시, 유지 관리, 모니터링 및 보안 유지할 수 있도록 돕는 완전 관리형 서비스
- RESTful API 및 WebSocket API 작성 가능
- 다양한 규모에서의 사용 가능

## 사용 사례

- 서드 파티 개발자용 서비스 제공
- 백엔드 서비스의 데이터, 비즈니스 로직, 기능에 액세스할 수 있는 '문' 역할

## API Gateway의 장점

## 확장성 및 모니터링

- 운영 오버헤드를 최소화하면서 보안 위협 방지
- Lambda 함수, EC2 인스턴스, 기타 AWS 서비스와의 통합 가능
- Direct Connect를 통해 온프레미스로 요청 전달 가능
- 여러 마이크로서비스를 위한 통합 API 프런트엔드 생성 가능

## 보안 및 인증

- AWS IAM, Amazon Cognito와 같은 AWS 보안 도구를 사용하여 API 액세스 권한 부여
- DDoS 보호 및 제한 기능 제공
- API 요청 조절, 측정, 수익 창출 가능(API 키 사용)

## API Gateway와 연동 가능한 서비스

## 다양한 서비스와의 통합

- **Lambda 함수:** 서버리스 형태로 마이크로서비스 구성
- **EC2 인스턴스:** 퍼블릭 엔드포인트와의 통합
- **온프레미스 서비스:** Direct Connect를 통한 통합
- **S3:** 정적 웹페이지 호스팅

## API Gateway의 예시 아키텍처

- 애플리케이션 클라이언트가 웹사이트에 요청 → S3 버킷에서 정적 웹페이지 제공
- 브라우저 내부에서 API Gateway로 요청을 보내는 로직 포함
- API Gateway가 요청을 Lambda 함수에 전달
- Lambda 함수가 DynamoDB 테이블에 데이터 쓰기/읽기
- CloudWatch Logs로 로그 전송 및 기록
- API Gateway 캐시 프로비저닝 및 크기 지정 가능

## 주요 기능 요약

## API 생성 및 관리

- **API 작성:** RESTful API 및 WebSocket API 작성 가능
- **배포 및 유지 관리:** API의 배포 및 유지 관리 용이

## 보안 및 인증

- **AWS 보안 도구 통합:** AWS IAM, Amazon Cognito와의 통합을 통해 인증 및 승인 관리
- **API 키:** 타사 개발자를 위한 API 요청 조절 및 수익 창출 가능

## 성능 최적화

- **캐싱:** API 호출에 캐싱 추가 가능, 성능 개선 및 백엔드 트래픽 감소

# Amazon SQS

## Amazon SQS (Simple Queue Service) 소개

### Amazon SQS의 기능 및 장점

- **완전 관리형 메시지 대기열 서비스:** 관리 부담 없이 최소한의 구성으로 사용 가능
- **확장성:** 하루에 수십억 건의 메시지 처리 가능
- **고가용성:** 여러 가용 영역을 사용하여 높은 가용성 보장
- **비동기 처리:** 발신자와 수신자 간 버퍼 역할을 통해 느슨하게 결합된 아키텍처 설계 가능

### 사용 사례

- **온프레미스 3티어 아키텍처:** 웹 서버와 애플리케이션 서버가 밀접하게 연결된 구조에서 메시지 대기열을 사용해 확장성 및 탄력성 확보
- **클라우드 환경에서의 문제 해결:** EC2 인스턴스에 메시지 대기열을 구성할 필요 없이 SQS 사용

## 느슨한 결합 아키텍처 예시

![](Pasted%20image%2020240610200726.png)
1. **생산자 애플리케이션:** 고객 주문 생성 후 Amazon SQS 대기열로 전송
2. **소비자 애플리케이션:** 대기열을 폴링하고 메시지 수신, Amazon RDS 데이터베이스에 기록 후 메시지 삭제
3. **배달 못한 편지 대기열:** 처리할 수 없는 메시지를 나중에 처리할 수 있도록 저장

### 느슨한 결합의 이점

- **비동기식 처리:** 생산자와 소비자 로직의 격리
- **내결함성:** 트랜잭션 장애 발생 시 주문 처리 재시도 가능
- **트래픽 급증 처리:** 대기열을 버퍼로 사용해 급증하는 트래픽을 처리

## SQS 대기열의 활용

![](Pasted%20image%2020240610201350.png)

### 표준 대기열 vs FIFO 대기열

- **표준 대기열:** 최소 1회 전송 보장, 높은 처리량, 메시지 순서 보장 X
	- ![](Pasted%20image%2020240610201404.png)
- **FIFO 대기열:** 정확히 1회 전송 보장, 메시지 순서 보장, 초당 API 호출 수 제한
	- ![](Pasted%20image%2020240610201411.png)

### 가시성 제한 시간

- **가시성 제한 시간:** 메시지가 다른 소비자에게 보이지 않도록 설정하는 시간, 기본값 30초

### 폴링 유형

- **짧은 폴링:** 빠른 응답, 높은 비용
- **긴 폴링:** 비용 절감, 실시간 응답 불가능

## SQS의 주요 활용 사례

### 비동기 작업 처리

- **상태 변경 알림:** 애플리케이션 상태 변화 시 비동기적으로 관리자에게 알림

### 메시지 대기열 안티 패턴

- **메시지 크기 제한:** 기본적으로 256KB 제한, 큰 메시지는 S3에 저장 후 위치 정보를 메시지에 포함

### Auto Scaling과의 통합

- **Auto Scaling:** SQS 대기열의 메시지 수를 기반으로 EC2 인스턴스 수 조정

Amazon SQS는 클라우드 환경에서 확장성과 가용성을 보장하며 운영 오버헤드를 최소화할 수 있는 강력한 메시지 대기열 서비스입니다. 이를 통해 비동기 작업을 효과적으로 처리하고, 트래픽 급증 시에도 안정적인 성능을 유지할 수 있습니다.

# Amazon SNS

## Amazon SNS (Simple Notification Service) 소개

![](Pasted%20image%2020240610201835.png)

### 기능 및 장점

- **알림 전송 서비스:** 클라우드에서 손쉽게 알림 설정, 운영 및 전송
- **게시-구독 (pub-sub) 패러다임:** 푸시 매커니즘을 사용하여 폴링 필요 없음
- **확장 가능성 및 비용 효율성:** 고도로 확장 가능하며 종량 과금제로 청구

### 사용 사례

- **푸시 알림 전송:** 애플리케이션 업데이트, 프로모션 메시지 등 특정 이벤트 시 사용자에게 알림
- **이메일 및 문자 메시지 전송:** 다양한 전송 프로토콜 지원

### SNS 주제 및 구독

- **주제 생성:** 주제에 대한 접근 제어 정책 정의
- **메시지 게시:** 게시자가 주제로 메시지 전송
- **구독자 관리:** 구독자는 주제에 게시된 모든 메시지를 수신

### 주요 활용 사례

- **이벤트 모니터링:** CloudWatch 경보, 이메일 알림 등 다양한 애플리케이션 요구사항 지원
- **워크플로 시스템:** 분산된 컴퓨팅 애플리케이션 간 이벤트 전달 및 데이터 이동

### 팬아웃 시나리오

![](Pasted%20image%2020240610202046.png)
- **메시지 복제:** SNS 주제로 전송된 메시지를 여러 SQS 대기열, HTTP 엔드포인트 또는 이메일 주소로 푸시
- **비동기 병렬 처리:** SNS가 여러 SQS 대기열로 주문을 팬아웃, 각 대기열을 폴링하여 다른 작업 수행

## SNS와 SQS의 비교

![](Pasted%20image%2020240610202036.png)
- **SNS:** 메시지가 영구적이지 않으며 푸시 메커니즘을 통해 여러 구독자에게 전송
- **SQS:** 폴링 모델을 통해 메시지 교환, 전송 및 수신 구성 요소 분리

### 결론

Amazon SNS는 클라우드 기반 애플리케이션에서 알림을 설정하고 전송하는 데 유용한 도구입니다. 이를 통해 실시간 이벤트 기반 애플리케이션을 구축하고, 푸시 알림을 통해 사용자와 효과적으로 소통할 수 있습니다. SNS와 SQS의 차이를 명확히 이해하고, 각각의 장점을 활용해 애플리케이션을 설계하면 더 높은 확장성과 유연성을 확보할 수 있습니다.

# Amazon Kinesis

## Amazon Kinesis 소개

### 데이터 처리의 중요성

- 데이터 처리는 매우 중요한 부분
- 실시간 및 배치 데이터가 있을 수 있음

### 실시간 스트리밍 데이터 요구사항 충족 서비스

![](Pasted%20image%2020240610202234.png)
- **Amazon Kinesis** 서비스들이 다양한 요구사항을 충족
- **Amazon Kinesis Data Streams**: 실시간으로 스트림 저장 및 수집
- **Amazon Kinesis Data Firehose**: 데이터 스트림 작업 자동화, AWS 데이터 스토어 전달
- **Amazon Managed Service for Apache Flink**: Apache Flink를 통한 데이터 스트림 분석
- **Amazon Kinesis Video Streams**: 비디오 데이터 수집, Rekognition과 통합 가능

### Amazon Kinesis Data Streams

![](Pasted%20image%2020240610202319.png)
- **다양한 작업에 활용:** 실시간 데이터 분석, 로그 이벤트 데이터 수집 등
- **스트림 생성 및 관리:** 샤드 수 지정, 초당 데이터 처리량 제한
- **생산자 및 소비자:** 다양한 플랫폼에서 데이터 송수신 가능
- **결과 데이터 저장:** Amazon S3, Amazon DynamoDB, Amazon Redshift 등 AWS 서비스 활용

### Amazon Kinesis Data Firehose

![](Pasted%20image%2020240610202342.png)
- **ETL 서비스:** 스트리밍 데이터 캡처 및 전환
- **자동 크기 조정:** 데이터 처리량에 따라 자동으로 크기 조정
- **데이터 전송:** Amazon S3, Amazon Redshift, 외부 HTTP 엔드포인트 등 다양한 대상으로 전송
- **완전 관리형 서비스:** 지속적인 관리 필요 없음

### 결론

Amazon Kinesis는 다양한 데이터 처리 요구를 충족시키는 실시간 스트리밍 데이터 서비스를 제공합니다. Kinesis Data Streams를 통해 데이터를 실시간으로 처리하고 분석하며, Kinesis Data Firehose를 사용하여 안정적으로 데이터를 캡처하고 전환하여 다양한 대상에 전송할 수 있습니다. 이를 통해 데이터 주기를 단축하고 비즈니스 인텔리전스에 실시간으로 접근할 수 있습니다.

# AWS Step Functions

## AWS Step Functions 소개

### 서버리스 워크플로우 관리의 어려움
- Lambda를 사용한 서버리스 워크플로우는 복잡성과 디버깅 어려움을 초래할 수 있음

### 해결책: AWS Step Functions
- **시각적 워크플로우 관리:** 분산 애플리케이션 및 마이크로서비스의 구성 요소를 시각적으로 관리
- **애플리케이션 변경 및 확장 용이성:** 기능별로 구성 요소를 조합하여 애플리케이션을 쉽게 변경 및 확장 가능
- **안정적인 워크플로우 관리:** 각 단계를 자동으로 트리거 및 추적하여 오류 발생 시 재시도 가능

### 주요 기능
- **시각적 워크플로우 디자인:** 그래픽 콘솔을 통한 다단계 애플리케이션 구축 및 실행
- **상태 기록 및 디버깅:** 각 단계의 상태를 기록하여 빠른 디버깅 가능
- **프로그래밍 없는 변경:** 코드 작성 없이 워크플로우 단계 변경 및 추가 가능

### AWS Step Functions의 원리
- **상태 머신 구현:** 상태 머신은 일련의 작동 조건을 가진 객체로서 출력을 결정
- **JSON 기반 Amazon States Language 사용:** 상태, 태스크, 선택, 오류 처리 등으로 구성된 JSON 형식의 언어 활용

### 활용 사례
- **Lambda 함수와의 연동:** Lambda 함수 연결 및 다양한 작업 시각적 구성 가능
- **트랜잭션 처리 예시:** 클라이언트 트랜잭션 완료 후 API Gateway 요청으로 Step Functions 워크플로우 시작
- **상태에 따른 종료 및 관리자 알림:** 성공시 종료, 실패시 관리자에게 알림 등의 작업 구성 가능

AWS Step Functions은 시각적 워크플로우 관리와 안정적인 워크플로우 실행을 통해 서버리스 애플리케이션의 복잡성을 해결하고, 손쉽게 관리할 수 있는 서비스입니다.

# 실습 5: 서버리스 아키텍처 구축

분산 애플리케이션 분리를 위해 이벤트 중심 아키텍처를 채택하는 AWS 솔루션스 아키텍트가 늘고 있습니다. 이러한 이벤트는 엄격한 순서에 따라 모든 구독 애플리케이션에 전파되어야 하는 경우가 많습니다. Amazon Simple Notification Service(Amazon SNS) 주제와 Amazon Simple Queue Service(Amazon SQS) 대기열을 사용하면 엔드 투 엔드 메시지 정렬, 중복 제거, 필터링, 암호화가 필요한 사용 사례를 해결할 수 있습니다. 이 실습에서는 객체가 Amazon Simple Storage Service(Amazon S3) 버킷에 추가될 때마다 Amazon SNS 알림을 호출하도록 S3 버킷을 구성합니다. SQS 대기열을 생성하고 상호 작용하는 방법과 Amazon SQS를 사용하여 AWS Lambda 함수를 호출하는 방법을 배웁니다. 이 시나리오는 Amazon SNS, AWS Lambda, Amazon SQS 같은 서버리스 서비스를 사용하여 Amazon S3 버킷 이벤트에 응답하도록 애플리케이션을 아키텍팅하는 방법을 이해하는 데 도움이 됩니다.

![](Pasted%20image%2020240610212706.png)


