---
date_created: 2024-06-02 16:49
author: 
date_published: 
url:
---
# 모듈 6 데이터베이스 서비스

![](Pasted%20image%2020240602170126.png)

# Amazon RDS

# Amazon DynamoDB

![](Pasted%20image%2020240602182438.png)
- 테이블: 테이블은 항목의 모음입니다. 각 테이블에는 0개 이상 의 항목이 있습니다.
- 항목: 항목은 전체 항목 중에서 고유하게 식별할 수 있는 속 성의 그룹입니다. 각 항목은 하나 이상의 속성으로 구성됩니다.
	- 테이블의 각 항목에는 해당 항목을 테이블의 다른 모든 항목과 구별하는 고유 식별자 또는 기본 키가 있습니 다. 기본 키 외에는 테이블에 스키마가 없습니다.
- 속성: 속성은 더 이상 나뉠 필요가 없는 기본적인 데이 터 요소입니다. 각 테이블에는 기본 키인 속성이 하나 이상 있어 야 합니다.
- 파티션 키: 파티션 키라고 알려진 하나의 속성으로 구성된 간단한 기본 키입니다. DynamoDB는 내부 해시 함수에 대한 입력으로 파티 션 키 값을 사용합니다. 해시 함수의 출력에 따라 항목 을 저장할 파티션(DynamoDB 내부의 물리적 스토리 지)이 결정됩니다. 파티션 키만 있는 테이블에서는 두 항목이 동일한 파티 션 키 값을 가질 수 없습니다.
- 복합 기본 키: 이 유형의 키는 2가지 속성으로 구성됩니다. 첫 번째 속성은 파티션 키이고, 두 번째 속성은 정렬 키입니다. DynamoDB는 파티션 키 값을 내부 해시 함수에 대한 입력으로 사용합니다. 해시 함수의 출력에 따라 항목을 저장할 파티션(DynamoDB 내부의 물리적 스토리지) 이 결정됩니다. 동일한 파티션 키 값을 갖는 모든 항목 은 정렬 키 값에 따라 정렬된 상태로 함께 저장됩니다. 파티션 키와 정렬 키가 있는 테이블에서는 여러 항목이 동일한 파티션 키 값을 가질 수 있습니다. 그러나 이러 한 항목에는 서로 다른 정렬 키 값이 있어야 합니다.
- 정렬 키: 항목의 정렬 키를 범위 속성이라고도 합니다. 범위 속 성이라는 용어는 DynamoDB가 동일한 파티션 키를 가진 항목을 정렬 키 값에 따라 정렬된 순서로 물리적 으로 서로 가깝게 저장하는 방식에서 파생됩니다.

### DynamoDB 용량 및 크기 조정

- 용량 계획 시 초당 읽기/쓰기 요청 수와 요청 크기를 고려해야 함
- 온디맨드 용량 모드
    - 요청 단위로 요금 부과
    - 워크로드를 알 수 없거나 트래픽 예측이 어려운 경우 유용
    - 트래픽이 한도를 초과하면 비용 제어를 위해 요청 제어
- 프로비저닝된 용량 모드
    - 트래픽이 예측 가능하거나 용량 요구사항 제한이 필요한 경우 사용
    - RCU(Read Capacity Unit)와 WCU(Writing Capacity Unit) 사용
        - WCU: 최대 1KB 크기 항목에 대한 초당 쓰기 요청
        - RCU: 최대 4KB 크기 항목에 대한 읽기 요청
- Auto Scaling을 통한 프로비저닝된 용량 조정 가능

### DynamoDB 일관성 옵션

- 테이블 데이터는 일반적으로 1초 내에 한 리전의 3개 가용 영역에 복제됨
- 일관성 옵션 두 가지
    1. 최종적 읽기 일관성 (기본)
        - 0.5 RCU 소모
        - 업데이트 전 데이터를 읽을 가능성 있음
    2. 강력한 읽기 일관성
        - 1 RCU 소모
        - 항상 일관된 데이터 확보 가능
- 데이터 일관성 요구사항에 따라 적절한 옵션 선택 필요

### DynamoDB 글로벌 테이블

- 완전 관리형, 서버리스, 다중 리전, 다중 활성 데이터베이스
- 99.999%의 가용성, 향상된 애플리케이션 복원력 및 비즈니스 연속성 제공
- 활성화한 리전에서 DynamoDB 테이블 자동 복제
    - 빠른 로컬 읽기 및 쓰기 성능 제공

로벌 테이블 사용 예시

- 다수의 고객기반 서비스를 여러 리전에서 제공하는 애플리케이션
- 글로벌 테이블 없이는 각 리전에 테이블 생성 및 데이터 변경사항 복제 코드 작성 필요
- 글로벌 테이블 사용 시, 각 지리적 영역에 가장 가까운 리전에 복제본 테이블 생성
    - DynamoDB가 모든 복제본의 변경사항을 자동으로 다른 리전 복제본에 복제
- 사용자 위치에 관계없이 데이터에 빠르게 액세스 가능
- 한 AWS 리전을 일시적으로 사용할 수 없어도 다른 리전 복제본 테이블에 계속 액세스 가능

![](Pasted%20image%2020240602182926.png)

# 데이터베이스 캐싱

### 캐싱 아키텍처

![](Pasted%20image%2020240602183058.png)

### 일반적인 캐싱 전략

- 지연 로딩(레이지 로딩)

지연 로딩에서는 캐시를 업데이트하지 않고 데이터베이스를 업데이트합니다. 캐시 미스의 경우 데이터베이스에서 검색된 정보가 나중에 캐시에 기록될 수 있습니다. 지연 로딩은 애플리케이션에 필요한 데이터를 캐시에 로드하지만, 일부 사용 사례에서는 캐시 미스 대 캐시 적중 비율이 높아질 수 있습니다.

지연 로딩 캐싱 전략의 단계는 다음과 같습니다.

1. 데이터를 캐시에 요청합니다.
2. 데이터가 캐시에 없으면 캐시 미스입니다.
3. 그런 다음, 데이터를 데이터 데이터베이스 인스턴스에 요청합니다.
4. 데이터 요청은 데이터베이스에서 제공됩니다.
5. 데이터베이스에서 반환된 데이터도 캐시에 저장됩니다.
 ![](Pasted%20image%2020240602183136.png)

- 동시 쓰기

캐싱 동시 쓰기에서는 데이터베이스 인스턴스에 대한 모든 쓰기가 캐시에도 기록됩니다. 

이렇게 하면 캐시 미스가 줄어듭니다. 

캐싱 동시 쓰기 전략의 단계는 다음과 같습니다.

1. 애플리케이션에서 데이터를 데이터베이스에 씁니다.
2. 애플리케이션에서 데이터를 캐시에도 씁니다.

![](Pasted%20image%2020240602183314.png)

### 캐시 관리

![](Pasted%20image%2020240602183353.png)

### Amazon ElastiCache

ElastiCache는 Redis, Memcached 엔진 등 2가지 오픈 소스 호환 인 메모리 데이터 스토어에서 작동합니다.

![](Pasted%20image%2020240602183442.png)

# 데이터베이스 마이그레이션 도구

# 실습 3: Amazon VPC 인프라에 데이터베이스 계층 생성

![](Pasted%20image%2020240602184016.png)


**참고:** 이 실습에서는 기존 Amazon VPC 구조에 AWS 데이터베이스와 데이터 계층을 도입하는 데 중점을 두는 데이터베이스 서비스 모듈을 따릅니다. 이 실습에서는 Amazon RDS 및 Application Load Balancer에 대해 보강합니다. 수강생 학습 목표는 ELB를 빌드하는 것입니다. 빌드된 ELB는 실습 3에서 사용되지는 않지만 실습 4의 핵심 구성 요소입니다. 제한된 시간 내에 강좌를 마쳐야 하므로, 실습 4에서 사용할 네트워킹 부분을 실습 3에서 만들게 하고 반복적인 빌드 프로세스를 제공합니다.

## 과제 1: Amazon RDS 데이터베이스 생성

![](Pasted%20image%2020240602194311.png)

![](Pasted%20image%2020240602194250.png)![](Pasted%20image%2020240602194522.png)

 **주의:** 드롭다운 메뉴에서 올바른 **DB cluster parameter group** 값을 선택해야 합니다. 잘못된 값을 선택하면 데이터베이스 복제본을 구축할 때 오류가 발생합니다.

## 과제 2: Application Load Balancer 생성 및 구성

![](Pasted%20image%2020240602194810.png)

이 과제에서는 퍼블릭 서브넷에 Application Load Balancer를 생성하여 브라우저에서 애플리케이션에 액세스합니다. Amazon EC2 콘솔로 이동하여 기존 Amazon VPC 인프라에 Application Load Balancer를 생성하고 프라이빗 EC2 인스턴스를 대상으로 추가합니다.

로드 밸런서는 클라이언트에 대한 단일 접점 역할을 수행합니다. 클라이언트는 로드 밸런서에 요청을 전송하고, 로드 밸런서는 EC2 인스턴스와 같은 대상에 요청을 전송합니다. 로드 밸런서를 구성하려면 대상 그룹을 생성한 다음 대상 그룹에 대상을 등록합니다.

### 과제 2.1: 대상 그룹 생성

### 과제 2.2: APPLICATION LOAD BALANCER 생성

![](Pasted%20image%2020240602195134.png)

AWS ALB(Application Load Balancer) 외에도 AWS에서는 다양한 로드 밸런싱 옵션을 제공합니다. 각 옵션의 특징과 ALB와의 차이점은 다음과 같습니다:

1. NLB (Network Load Balancer)

- Layer 4 (TCP/UDP) 수준에서 로드 밸런싱을 수행합니다.
- IP 프로토콜과 포트 번호를 기반으로 트래픽을 분산합니다.
- 고정 IP 주소를 제공하며, 초당 수백만 건의 요청을 처리할 수 있어 대규모 트래픽에 적합합니다.
- ALB와 달리 콘텐츠 기반 라우팅, 경로 기반 라우팅 등의 기능은 제공하지 않습니다.

2. CLB (Classic Load Balancer)

- ALB의 이전 세대 로드 밸런서로, Layer 4와 Layer 7 수준의 로드 밸런싱을 모두 지원합니다.
- HTTP, HTTPS, TCP, SSL 프로토콜을 사용할 수 있습니다.
- ALB에 비해 기능이 제한적이며, 콘텐츠 기반 라우팅, 호스트 기반 라우팅 등은 지원하지 않습니다.
- 고정 IP 주소를 제공하지 않으며, 초당 처리 가능한 요청 수도 ALB에 비해 적습니다.

3. Gateway Load Balancer

- Layer 3 (Network) 수준에서 로드 밸런싱을 수행합니다.
- 주로 가상 어플라이언스(방화벽, IDS 등)를 통해 트래픽을 라우팅하는 데 사용됩니다.
- 투명한 네트워크 게이트웨이 역할을 수행하며, IP 주소를 보존합니다.
- ALB와 달리 애플리케이션 계층의 기능은 제공하지 않습니다.

4. ECS (Elastic Container Service) 서비스 로드 밸런싱

- ECS 클러스터 내의 컨테이너 간에 트래픽을 분산합니다.
- ALB, NLB, CLB를 모두 사용할 수 있으며, 서비스 디스커버리 기능을 통해 동적으로 대상을 등록할 수 있습니다.
- 컨테이너 수준에서의 로드 밸런싱이 가능하다는 점이 ALB와의 주요 차이점입니다.

5. Route 53 DNS 기반 로드 밸런싱

- DNS 레벨에서 트래픽을 분산하는 방식으로, 지리적 위치, 지연 시간, 가중치 등 다양한 라우팅 정책을 지원합니다.
- 상태 확인을 통해 건강한 엔드포인트로만 트래픽을 라우팅할 수 있습니다.
- ALB와 달리 애플리케이션 계층의 기능은 제공하지 않으며, DNS 캐싱으로 인한 지연이 발생할 수 있습니다.

이 외에도 Lambda@Edge, Global Accelerator 등 특수한 용도의 로드 밸런싱 옵션도 있습니다. 애플리케이션의 요구사항과 아키텍처에 따라 적절한 로드 밸런서를 선택하는 것이 중요합니다.




 이 과제에서는 Application Load Balancer를 생성하고 EC2 인스턴스를 로드 밸런서에 대상으로 추가했습니다. 이 과제에서는 대상을 로드 밸런서에 등록하는 방법을 보여줍니다. 개별 EC2 인스턴스 외에 Auto Scaling 그룹도 로드 밸런서의 대상으로 등록할 수 있습니다. Auto Scaling 그룹을 로드 밸런싱의 대상으로 사용하는 경우 Auto Scaling 그룹이 시작하는 인스턴스는 로드 밸런서에 자동으로 등록됩니다. 마찬가지로 Auto Scaling 그룹이 종료하는 EC2 인스턴스는 로드 밸런서에서 자동으로 등록 취소됩니다. 로드 밸런서와 함께 Auto Scaling 그룹을 사용하는 방법은 다음 실습에서 설명합니다.
 

## 과제 3: 콘솔을 통해 Amazon RDS DB 인스턴스 메타데이터 검토


