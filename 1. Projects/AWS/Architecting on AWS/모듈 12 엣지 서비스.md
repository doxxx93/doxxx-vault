---
date_created: 2024-06-11 09:28
author: 
date_published: 
url:
---
# 모듈 12 엣지 서비스

![](Pasted%20image%2020240611093019.png)

## 엣지란 무엇인가요?

- **엣지 컴퓨팅:** 클라우드 컴퓨팅 자원 및 서비스를 고객과 가까운 위치에서 실행하여 지연 시간을 최소화하는 것

## AWS의 엣지 솔루션

- **AWS Snow Family:** 오프라인 데이터 전송을 지원하는 솔루션
  - **Snowball Edge:** 대용량 데이터 전송 및 컴퓨팅 기능 제공
  - **Snowcone:** 소형, 경량 데이터 전송 디바이스
- **AWS Outposts:** 고객 데이터 센터에 AWS 인프라를 배치하여 하이브리드 클라우드 환경 구현
  - **AWS Outposts:** 물리적 AWS 랙 또는 서버를 배치하여 온프레미스에서 AWS 서비스 사용 가능
- **AWS Local Zone:** 특정 지역에서 낮은 지연 시간을 요구하는 애플리케이션을 지원하기 위한 가용 영역의 확장
  - **활용 사례:** 게임 애플리케이션, 비디오 스트리밍 등
- **엣지 로케이션:** 전 세계에 분산된 수백 개의 데이터 센터로, 최소한의 구성으로 운영 범위 확장 가능

## AWS 엣지 컴퓨팅 아키텍처 구성 요소

- **AWS 리전:** 지리적 위치에 따라 구분된 AWS 인프라, 각 리전 내에는 다수의 가용 영역이 존재
- **가용 영역:** 리전 내의 물리적 데이터 센터, 높은 가용성과 내구성을 제공하기 위해 다중 가용 영역 사용

## 엣지 서비스를 활용하는 일반적인 아키텍처

![](Pasted%20image%2020240611094522.png)
1. **DNS 확인 - Route 53:**
   - 글로벌 DNS 서비스, 도메인 이름을 IP 주소로 변환
2. **웹 애플리케이션 방화벽 - AWS WAF:**
   - 애플리케이션 수준에서 방화벽 역할, 웹 애플리케이션 보호
3. **데이터 캐싱 - Amazon CloudFront:**
   - 콘텐츠 전송 네트워크(CDN) 서비스, 데이터를 엣지 로케이션에서 캐싱하여 빠른 응답 시간 제공
4. **하이브리드 아키텍처 - AWS Outposts:**
   - 온프레미스에서 AWS 서비스 통합, 하이브리드 클라우드 환경 구현
5. **보안 - AWS Shield:**
   - DDoS 공격 방어 서비스, AWS 클라우드의 모든 자원 보호

## 엣지 컴퓨팅의 장점

- **낮은 지연 시간:** 고객과 가까운 위치에서 서비스 제공으로 지연 시간 최소화
- **높은 가용성:** 분산된 엣지 로케이션과 가용 영역을 통해 높은 가용성 제공
- **확장성:** 필요에 따라 쉽게 확장 가능한 인프라 제공
- **보안:** AWS Shield를 통한 보안 강화, AWS WAF를 통한 애플리케이션 보호

# Amazon Route 53

## Amazon Route 53 개요

Amazon Route 53은 AWS의 가용성과 확장성을 갖춘 DNS(Domain Name System) 웹 서비스입니다. 이 서비스는 도메인 이름을 등록하고, 도메인 이름을 엔드포인트로 확인할 수 있는 기능을 제공합니다. 엔드포인트는 MX, IPv4의 IP 주소인 AAAA, TXT 등의 다양한 유형으로 구성할 수 있습니다.

## 기능 및 특성

### 도메인 이름 등록

- **도메인 등록:** AWS가 등록 기관이 되어 Route 53에서 도메인 이름을 구입하고 등록할 수 있습니다.
- **도메인 전송:** 기존 도메인을 Route 53으로 전송할 수 있습니다.

### DNS 확인 유형

Route 53은 다양한 유형의 DNS 확인을 지원합니다:
- **퍼블릭 호스팅 영역:** 외부에서 접근 가능한 도메인 영역. 예: 인터넷을 통해 `example.com`으로 접속 시 EC2 인스턴스로 접근 가능.
	- ![](Pasted%20image%2020240611100716.png)
- **프라이빗 호스팅 영역:** 내부 VPC나 온프레미스와 연결된 하이브리드 클라우드 환경에서 사용하는 도메인 영역. 예: 내부 네트워크에서만 접근 가능한 도메인 설정.
	- ![](Pasted%20image%2020240611100725.png)

## 라우팅 정책

Route 53은 다양한 라우팅 정책을 제공하여 복잡한 트래픽 관리 요구사항을 충족할 수 있습니다:
- **단순 라우팅:** 가장 기본적인 라우팅 방식으로 단일 엔드포인트를 가리킵니다.
- **장애 조치 라우팅:** 활성 리전에 트래픽을 보내다가 장애가 발생하면 대기 리전으로 전환.
- **가중치 기반 라우팅:** 각 엔드포인트에 가중치를 두어 트래픽을 분산. AB 테스트나 블루/그린 배포에 유용.
- **지리적 위치 라우팅:** 사용자의 지리적 위치에 따라 엔드포인트로 라우팅.
- **지연 시간 기반 라우팅:** 네트워크 지연 시간이 가장 짧은 엔드포인트로 라우팅.
- **지리적 근접 라우팅:** 사용자와 리소스의 지리적 위치에 따라 트래픽을 라우팅.
- **다중값 응답:** 무작위로 선택된 엔드포인트로 트래픽을 분산.

## 실습 시나리오 예시

### 단순 라우팅 예시

- 글로벌 서비스 제공 시 특정 리전의 엔드포인트를 가리키도록 설정합니다. 예: `eu-west-2` 리전의 엔드포인트로 트래픽을 라우팅.

### 장애 조치 라우팅 예시

- 두 개의 리전을 구성하고 하나는 활성 상태, 다른 하나는 대기 상태로 설정. 활성 리전에 장애가 발생하면 대기 리전으로 트래픽 전환.

### 가중치 기반 라우팅 예시

- 여러 엔드포인트에 가중치를 설정하여 트래픽을 분산. 예: 가중치 80%는 `endpoint1`로, 20%는 `endpoint2`로 전송.

### 지리적 위치 라우팅 예시

- 사용자 위치에 따라 엔드포인트를 지정. 예: 유럽 사용자는 유럽 리전으로, 미국 사용자는 미국 리전으로 연결.

### 지연 시간 기반 라우팅 예시

- 네트워크 지연 시간이 짧은 엔드포인트로 라우팅. 예: `us-east-1` 리전의 지연 시간이 137ms, `eu-west-2` 리전의 지연 시간이 76ms일 때, `eu-west-2` 리전으로 트래픽 라우팅.

### 지리적 근접 라우팅 예시

- 지리적 편향을 사용하여 특정 리소스에 트래픽을 라우팅. 특정 지리적 영역을 사용자 지정하고 라우팅을 설정.

### 다중값 응답 예시

- 여러 엔드포인트 중 무작위로 선택된 엔드포인트로 트래픽을 분산. 예: `example.com`에 대해 10.1.1.1, 10.1.1.2, 10.1.1.3 중 하나로 연결.

## 요약

Amazon Route 53은 다양한 방법으로 DNS를 확인하고 글로벌 범위에서 뛰어난 성능을 제공하는 DNS 서비스입니다. 높은 가용성과 확장성을 갖춘 이 서비스는 다양한 라우팅 정책을 통해 복잡한 트래픽 관리 요구사항을 손쉽게 충족할 수 있습니다.

# Amazon CloudFront

## Amazon CloudFront 개요

Amazon CloudFront는 AWS의 콘텐츠 전송 네트워크(CDN) 서비스입니다. 이 서비스는 필요한 콘텐츠를 고객의 위치와 가까운 엣지 로케이션에 캐시하여 전송 속도와 성능을 향상시킵니다. 이를 통해 글로벌 사용자가 보다 빠르고 안정적으로 콘텐츠를 이용할 수 있게 합니다.

## CloudFront의 주요 기능

### 전 세계 엣지 로케이션

AWS는 전 세계에 걸쳐 수백 개의 상호 접속 위치(POP)를 보유하고 있습니다. 이를 통해 최종 사용자는 자신과 가까운 엣지 로케이션으로 요청을 보내 빠르게 콘텐츠를 전송받을 수 있습니다.

### 오리진에 가해지는 부하 절감

CloudFront를 사용하면 오리진 서버에 가해지는 부하를 크게 줄일 수 있습니다. 처음 요청 시 오리진에서 콘텐츠를 캐시하고, 이후 요청은 캐시된 데이터로 응답하여 오리진 서버의 부하를 줄입니다.

## CloudFront 데모 예시

### NGINX 웹 서버 설정

1. **EC2 인스턴스 설정:** 버지니아 북부 리전에 EC2 인스턴스를 프로비저닝하고 NGINX 웹 서버를 설치합니다.
2. **Systems Manager 사용:** 브라우저 기반으로 EC2 인스턴스에 접근하여 NGINX 액세스 로그를 확인합니다.
3. **웹 페이지 요청:** 퍼블릭 IP 주소를 사용하여 웹 페이지를 요청하면 NGINX 액세스 로그에 해당 요청이 기록됩니다.

### CloudFront 설정

1. **CloudFront 구성:** EC2 인스턴스를 오리진으로 하는 CloudFront를 설정합니다.
2. **DNS 정보 사용:** CloudFront의 DNS 정보를 사용하여 웹 페이지를 요청합니다. 처음 요청 시 NGINX 액세스 로그에 기록되지만 이후 요청은 캐시된 데이터로 응답하여 NGINX 로그에 기록되지 않습니다.

### 성능 비교

1. **직접 요청:** 서울에서 버지니아 북부에 있는 EC2 인스턴스로 직접 요청 시 응답 시간이 약 391ms입니다.
2. **CloudFront 사용:** 동일한 요청을 CloudFront를 통해 수행 시 응답 시간이 약 15ms로 크게 단축됩니다.

## 요약

Amazon CloudFront는 글로벌 사용자가 빠르고 안정적으로 콘텐츠를 이용할 수 있게 하는 CDN 서비스입니다. 엣지 로케이션을 통해 콘텐츠를 캐시하고, 오리진 서버에 가해지는 부하를 줄이며, 성능 향상을 제공합니다. CloudFront를 사용하여 콘텐츠 전송을 최적화하고 사용자 경험을 향상시킬 수 있습니다.

# AWS DDoS 방어 및 엣지 서비스

## DDoS 방어 개요

DDoS(Distributed Denial of Service) 공격은 여러 출처에서 동시에 특정 시스템을 대상으로 대량의 트래픽을 발생시켜 서비스를 방해하는 공격입니다. 이러한 공격을 방어하기 위해 AWS는 다양한 보안 서비스를 제공합니다.

## OSI 모델과 DDoS 공격

OSI 모델에는 1계층(물리적 계층)부터 7계층(애플리케이션 계층)까지의 네트워크 계층이 있습니다. 대부분의 DDoS 공격은 3계층과 4계층(네트워크 및 전송 계층)에서 발생하지만, 애플리케이션 계층 공격도 빈번합니다.

## AWS Shield

AWS Shield는 AWS에서 실행되는 애플리케이션을 보호하는 관리형 DDoS 방어 서비스입니다.
- **AWS Shield Standard:** 기본적으로 제공되는 서비스로, 4계층까지의 방어를 지원합니다.
- **AWS Shield Advanced:** 추가 비용이 발생하며, 7계층까지의 방어를 지원합니다.

## AWS WAF (Web Application Firewall)

AWS WAF는 웹 애플리케이션을 보호하는 방화벽 서비스입니다. 다양한 AWS 서비스와 통합되어 작동합니다.
- **웹 ACL:** 웹 애플리케이션의 액세스를 제어하는 규칙 모음입니다. 
- **규칙:** SQL 삽입 공격 방어, 애플리케이션의 특정 경로에 대한 공격 방어 등 다양한 규칙을 설정할 수 있습니다.
- **통합 서비스:** CloudFront, Application Load Balancer, API Gateway, AWS AppSync 등과 통합되어 작동합니다.

## AWS WAF 기능

- **로그 저장:** Kinesis Data Firehose, Amazon S3, CloudWatch Logs에 로그 데이터를 저장합니다.
- **지표 저장:** Amazon CloudWatch에 지표 정보를 저장합니다.
- **속도 제한:** 트래픽을 속도 제한 기반으로 필터링할 수 있습니다.
- **지오 펜싱:** 국가별로 트래픽을 제한할 수 있습니다.

## AWS Firewall Manager

AWS Firewall Manager는 여러 계정과 리소스에 대한 보안 규칙을 중앙에서 관리하고 시각화할 수 있는 서비스입니다.
- **중앙 관리:** 여러 계정의 보안 규칙을 중앙에서 설정하고 관리할 수 있습니다.
- **시각화:** 조직 전체에 대한 보안 상태를 시각적으로 확인할 수 있습니다.

## DDoS 복원력 아키텍처

DDoS 복원력을 위해 다양한 AWS 서비스를 사용할 수 있습니다.
- **CloudFront:** 콘텐츠를 엣지에서 캐시하여 서버로의 요청을 줄입니다.
- **AWS Shield와 WAF:** DDoS 공격을 완화합니다.
- **Elastic Load Balancer:** 리전 수준에서 로드 밸런싱을 수행합니다.
- **Auto Scaling:** DDoS 공격을 흡수하기 위해 자동으로 인스턴스를 확장합니다.

## 요약

AWS는 DDoS 공격을 방어하기 위해 다양한 보안 서비스를 제공합니다. AWS Shield와 WAF는 DDoS 공격을 완화하고 대응할 수 있도록 도와줍니다. AWS Firewall Manager는 여러 계정과 리소스에 대한 보안 규칙을 중앙에서 관리하고 시각화할 수 있습니다. DDoS 복원력을 위해 다양한 AWS 서비스를 통합하여 심층적인 보안 체계를 구축할 수 있습니다.

## 다음 주제: AWS Outposts

DDoS 방어와 엣지 서비스에 대한 설명을 마쳤습니다. 다음 주제로 AWS Outposts에 대해 살펴보겠습니다.

# 실습 6: Amazon S3 오리진으로 Amazon CloudFront 배포 구성

실습 환경에서 함께 시작할 수 있는 몇 가지 리소스가 제공됩니다. 퍼블릭 액세스가 가능한 웹 서버로 활용되는 EC2 인스턴스의 Auto Scaling 그룹이 있습니다. 웹 서버 인프라가 Amazon Virtual Private Cloud(Amazon VPC)에 배포되고 다중 가용 영역에 맞게 구성되며 로드 밸런서도 사용합니다. 실습에서는 이 로드 밸런서를 오리진으로 하는 CloudFront 배포도 제공합니다.

다음 다이어그램은 이 실습이 끝날 때의 일반적 아키텍처를 보여 줍니다. 이 실습에서는 기존 실습 환경용으로 새 S3 버킷을 생성합니다. 그런 다음 기존 CloudFront 배포의 안전한 새 오리진으로 이 버킷을 구성합니다.

![](Pasted%20image%2020240611104010.png)

## 과제 1: 기존 CloudFront 배포 살펴보기


## 과제 2: S3 버킷 생성


## 과제 5: Amazon CloudFront 및 오리진 액세스 제어로 버킷 보호

```json
{
    "Version": "2012-10-17",
    "Statement": {
        "Sid": "AllowCloudFrontServicePrincipalReadOnly",
        "Effect": "Allow",
        "Principal": {
            "Service": "cloudfront.amazonaws.com"
        },
        "Action": [
            "s3:GetObject",
            "s3:GetObjectVersion"
        ],
        "Resource": "arn:aws:s3:::lab-bucket-684579519/*",
        "Condition": {
            "StringEquals": {
                "AWS:SourceArn": "arn:aws:cloudfront::710366170517:distribution/E1EGVI698QQIC"
            }
        }
    }
}

```